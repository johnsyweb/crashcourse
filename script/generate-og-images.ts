#!/usr/bin/env ts-node

import puppeteer, { Browser } from 'puppeteer';
import * as path from 'path';

interface ScreenshotConfig {
  name: string;
  url: string;
  waitForSelector?: string;
  waitForTimeout?: number;
  viewport?: { width: number; height: number };
}

const screenshotConfigs: ScreenshotConfig[] = [
  {
    name: 'og-image',
    url: 'http://localhost:5173',
    waitForSelector: '#root',
    waitForTimeout: 3000,
    viewport: { width: 1200, height: 630 }, // Standard OG image size
  },
  {
    name: 'og-image-with-course',
    url: 'http://localhost:5173/crashcourse/?course=eyJwb2ludHMiOltbLTM3LjczMzQ2NDE5NDQ2MTcsMTQ0Ljk2ODU2NTMzOTIyMjU1XSxbLTM3LjczMzMzOTMwNDEwNDQ1LDE0NC45NjgzMzAwNTkyMDA1M10sWy0zNy43MzMyMzI4NTM5MzQxNywxNDQuOTY4MTQ2MjQ0MDYzOTddLFstMzcuNzMzMTk5MDc0ODY0MzksMTQ0Ljk2NzkwOTM3MTQ4MDM1XSxbLTM3LjczMzEyMjg4MzM2NDU2LDE0NC45Njc2NzY1MjIyMTAyNF0sWy0zNy43MzMwOTQ0Njg3MTI4MSwxNDQuOTY3NDQzMDg2MjA2OV0sWy0zNy43MzMwNDU4NTM2NzQ0MSwxNDQuOTY3MjA5MzE0OTI3NDZdLFstMzcuNzMzMDMwNTk4NjEwNjQsMTQ0Ljk2NzE2ODI0MzYwMTkyXSxbLTM3LjczMjk1NDMyMzI5MTc4LDE0NC45NjY5MzcxNTQ1MzE0OF0sWy0zNy43MzI5MjE4MDE1MDc0NywxNDQuOTY2Njc1MzAzODc2NF0sWy0zNy43MzI5MDY0NjI2MjQ2NywxNDQuOTY2NDIxNTgzNjY3NF0sWy0zNy43MzI4Njk2NjYwNjk3NDYsMTQ0Ljk2NjE4MDYwMzk1MTIyXSxbLTM3LjczMjc5NjA3Mjk1OTksMTQ0Ljk2NTk2NTUyNDMxNTgzXSxbLTM3LjczMjY3Mzc4MDk5MjYzLDE0NC45NjU3OTYyMDk4NzE3N10sWy0zNy43MzI1OTA3MTYzMzIyLDE0NC45NjU4MDQzNDAzMTc4NV0sWy0zNy43MzI0MzI5Njg5MTQ1MSwxNDQuOTY1OTE5NDIzODQ4NF0sWy0zNy43MzIyODAyNTA2Mzg3MiwxNDQuOTY2MTA1NjY5NzM2ODZdLFstMzcuNzMyMTc3MzIwODY3NzgsMTQ0Ljk2NjMyOTg4NTY0NjddLFstMzcuNzMyMTYwNDczMjQyNCwxNDQuOTY2NTkyMDcxNTc3OV0sWy0zNy43MzIyMTM4NjU5NjU2MDUsMTQ0Ljk2Njg0MzY5NjMxMTEyXSxbLTM3LjczMjI0MzI4NjQ0NTc0LDE0NC45NjcwNzkxNDM5NzEyXSxbLTM3LjczMjI1OTEyODI0MjczLDE0NC45NjczMTYxMDAzNzM4Nl0sWy0zNy43MzIyODg4ODM5OTg5OSwxNDQuOTY3NTcyNDE4OTcyODVdLFstMzcuNzMyMzUwNzQyNDQ0Mzk2LDE0NC45Njc4MTExMzU1NzUxOF0sWy0zNy43MzI0MTM4NTgxNzUyOCwxNDQuOTY4MDU2MTM4NjA0ODhdLFstMzcuNzMyNDg2NTI5Mjc1Nzc1LDE0NC45NjgyODg5ODc4NzQ5OF0sWy0zNy43MzI1NzQ3MDY4OTcxNCwxNDQuOTY4NDkyMzMyODQ1OTNdLFstMzcuNzMyNzAyNzgyMzc3NiwxNDQuOTY4Njc0MTM2MzI1NzJdLFstMzcuNzMyODQ5MDQ2NTg3OTQ0LDE0NC45Njg4NTk0NjAyMDQ4NF0sWy0zNy43MzI5OTYwNjUxNjk1NywxNDQuOTY5MDUwMTQ4NTAyXSxbLTM3LjczMzA4MzkwNzUxNDgxLDE0NC45NjkyODE5MDgxMjQ2OV0sWy0zNy43MzMxNjY4ODgzNTYyMSwxNDQuOTY5NTI0Mzk2NTgzNDRdLFstMzcuNzMzMjU2NDA3MDgyMDgsMTQ0Ljk2OTc2MzUzMjI4MDkyXSxbLTM3LjczMzM5MDM0OTg5NDc2LDE0NC45Njk5MjM4NzgwODg2XSxbLTM3LjczMzU0MTg5NDcwNDEsMTQ0Ljk3MDA4NDA1NjI1ODJdLFstMzcuNzMzNjg2MTQ3MjU3Njg2LDE0NC45NzAyNTQzNzY1MzA2NV0sWy0zNy43MzM4MzAxNDgzNTQxNywxNDQuOTcwNDAwODkyMTk4MDldLFstMzcuNzMzOTc3MDgzMTE2NzcsMTQ0Ljk3MDU2ODY5Nzg5OTU4XSxbLTM3LjczNDExMzM3Mjg2MjM0LDE0NC45NzA3NDE0NDg5MjM5NV0sWy0zNy43MzQyMzkxMDE0MDk5MSwxNDQuOTcwOTM0NzM1NjExMDhdLFstMzcuNzM0MzA1ODIxMzU5MTYsMTQ0Ljk3MTE0NTcwODExMzldLFstMzcuNzM0NDA4NDE1ODUzOTgsMTQ0Ljk3MTM2MTU0MjEyMDU4XSxbLTM3LjczNDUxNzA0NTMxOTA4LDE0NC45NzE1NTE4OTUxNDE2XSxbLTM3LjczNDY0MDI1OTI5NTcsMTQ0Ljk3MTc0NzI3NzMwNDUzXSxbLTM3LjczNDgwODA2NDk5NzE5NiwxNDQuOTcxODU2NDkzNTAyODZdLFstMzcuNzM0OTUzMzIzMzc5MTYsMTQ0Ljk3MjAzNTE5NTY3ODQ3XSxbLTM3LjczNDk5NjY1NzgxODU1NiwxNDQuOTcyMTg5MDAzNjAxNjddLFstMzcuNzM0OTE2MzU5MTg2MTcsMTQ0Ljk3MjQxNTIzMTE2ODI3XSxbLTM3LjczNDc2MTU0NTQzNDU5NCwxNDQuOTcyNjAyNzM0MzQyMjJdLFstMzcuNzM0NTk4MDk4MzIyNzUsMTQ0Ljk3MjcyMzg1Mjg0MzA1XSxbLTM3LjczNDQzMjEzNjYzOTk1LDE0NC45NzI4Nzk5MjM4ODAxXSxbLTM3LjczNDI4NTYyMDk3MjUxNCwxNDQuOTczMDQyMjgxMzQ0NTNdLFstMzcuNzM0MTM0NjYyODk2Mzk1LDE0NC45NzMxOTY0MjQ1NDM4Nl0sWy0zNy43MzM5OTE4MzUyNjYzNSwxNDQuOTczMzM3OTk0ODg4NDJdLFstMzcuNzMzODY3MjgwMTg1MjIsMTQ0Ljk3MzUyMTMwNzExMDhdLFstMzcuNzMzNzYzOTMxMzE5MTIsMTQ0Ljk3MzcxOTUzOTEyMDhdLFstMzcuNzMzNjg1MTQxNDI5MzA1LDE0NC45NzM5NDQyNTc5NDQ4Ml0sWy0zNy43MzM2MTAwMzk1NzY4OSwxNDQuOTc0MTk2MDUwMzE2MV0sWy0zNy43MzM1NDAwNTA2ODU0MDYsMTQ0Ljk3NDQyODczMTk0ODE0XSxbLTM3LjczMzQzNTY5NTk5MDkyLDE0NC45NzQ2MTEyMDU5ODAxOF0sWy0zNy43MzMzNjQ3MDEyNzEwNiwxNDQuOTc0ODMxMzE0NzU3NDddLFstMzcuNzMzMzQxODE4Njc1NCwxNDQuOTc1MDc1MTQ0MzIwNzNdLFstMzcuNzMzMzI0ODg3MjMwOTksMTQ0Ljk3NTMwNzIzOTIxOTU1XSxbLTM3LjczMzM3MDMxNzE0NjE4LDE0NC45NzU1NzEzNTI5ODg0OF0sWy0zNy43MzM0NjIxODI4MDQ5NCwxNDQuOTc1ODAzNTMxNzA2MzNdLFstMzcuNzMzNTkzNjk0ODY1NzA0LDE0NC45NzYwMDA1MDY0MzA4Nl0sWy0zNy43MzM2OTM0Mzk1MTM0NDUsMTQ0Ljk3NjIzMDE3MDU3Nzc2XSxbLTM3LjczMzY3OTUyNTU1NDE4LDE0NC45NzYzODk5Mjk2NTIyXSxbLTM3LjczMzgzNTU5NjU5MTIzNCwxNDQuOTc2NDkyNjA3OTY2MDddLFstMzcuNzMzOTc3NjY5ODQ5OTksMTQ0Ljk3NjQ2NTk1MzUxMzk4XSxbLTM3LjczNDEzMTU2MTU5MjIyLDE0NC45NzYzMjc0MDA2NTQ1NV0sWy0zNy43MzQzMTY1NTAxOTUyMiwxNDQuOTc2MjEwMDU0MDEwMTVdLFstMzcuNzM0NTI4NTI4NTI2NDI1LDE0NC45NzYyMzk3MjU5NDczOF0sWy0zNy43MzQ3MTAyNDgxODcxODQsMTQ0Ljk3NjMzNDI3MzgxNTE2XSxbLTM3LjczNDg5MjEzNTQ4NjAxLDE0NC45NzY0NzE0ODU1NzAwN10sWy0zNy43MzUwNjUzODk0MjQ1NiwxNDQuOTc2NTgzMTMyNTIwMzJdLFstMzcuNzM1MjM3NTUzNzE1NzA2LDE0NC45NzY2Njk4MDEzOTkxXSxbLTM3LjczNTQ0ODg2MTQ5NDY2LDE0NC45NzY3MzU3NjY5NzcwN10sWy0zNy43MzU2MzUyNzUwMjExOTUsMTQ0Ljk3NjgyNzYzMjYzNTgzXSxbLTM3LjczNTgyMjEwNzY0Mjg5LDE0NC45NzY4MzA3MzM5NF0sWy0zNy43MzYwMTY2NTE2MTU1LDE0NC45NzY3OTQxODg4NDIxOF0sWy0zNy43MzYyMDkxMDAxMTIzMiwxNDQuOTc2ODAwMjIzODEyNDZdLFstMzcuNzM2MjU5MzkxNTMxMzUsMTQ0Ljk3NzAyMjA5Mjc4OTRdLFstMzcuNzM2Mjg4MTQxNDU5MjMsMTQ0Ljk3NzI2OTEwNzQ3NTg4XSxbLTM3LjczNjQ1NjYxNzcxMjk3NSwxNDQuOTc3NDM2MDc0OTg3MDVdLFstMzcuNzM2NjI5NzA0MDEzNDcsMTQ0Ljk3NzU4MDk5ODA5MjldLFstMzcuNzM2ODE1Mjc5MzQ5Njg1LDE0NC45Nzc2Nzc1NTc2MTc0M10sWy0zNy43MzY5ODkzNzE0Nzg1NiwxNDQuOTc3Nzg1MDk3NDM1MTJdLFstMzcuNzM3MTY2MDYxOTk3NDE0LDE0NC45Nzc4NzEwOTU3NjE2Nl0sWy0zNy43MzcyNTczNDA5MjI5NSwxNDQuOTc3OTYzMDQ1MjM5NDVdLFstMzcuNzM3NDE0ODM2ODgzNTQ1LDE0NC45NzgxMDIxMDEwMTMwNl0sWy0zNy43Mzc2MDI0MjM4NzY1MjQsMTQ0Ljk3ODIwNDUyNzg2OTgyXSxbLTM3LjczNzc4MTg4MDQyMzQzLDE0NC45NzgyODA4MDMxODg2OF0sWy0zNy43Mzc4NDIxNDYzMDcyMywxNDQuOTc4MzAxODQxNzY1NjRdLFstMzcuNzM4MDM4OTUzMzkzNywxNDQuOTc4MzQ5OTUzODg5ODVdLFstMzcuNzM4MjI1NzAyMTk2MzYsMTQ0Ljk3ODM4MzgxNjc3ODY2XSxbLTM3LjczODQzNDkxNDQ5OTUyLDE0NC45Nzg0MzA5MjMwNzQ0OF0sWy0zNy43Mzg2MDAxMjE4MTEwMywxNDQuOTc4NTI4OTkxMzQxNl0sWy0zNy43Mzg3ODE3NTc2NTI3NiwxNDQuOTc4NjQ1MzMyMTU3Nl0sWy0zNy43Mzg5ODIyNTI3NzY2MiwxNDQuOTc4NjE3NjcxODc3MTVdLFstMzcuNzM5MTY4NjY2MzAzMTYsMTQ0Ljk3ODY5OTg5ODM0NzI2XSxbLTM3LjczOTM1MTU1OTQzMDM2LDE0NC45Nzg3NzMwNzIzNjE5NV0sWy0zNy43Mzk1NTY5MTYwNTgwNiwxNDQuOTc4NzMxMTYyODQ2MV0sWy0zNy43Mzk3MzUwMzE1MDA0NiwxNDQuOTc4NjY3MjA4OTI0OV0sWy0zNy43Mzk4OTI2MTEyODAwODQsMTQ0Ljk3ODYwMjkxOTcyNzU2XSxbLTM3Ljc0MDAwNTg1MDc5MTkzLDE0NC45Nzg2MDkzNzM3OTNdLFstMzcuNzQwMDQ5ODU1NzgzNTgsMTQ0Ljk3ODYyNzMxMTA2NThdLFstMzcuNzQwMDEzOTgxMjM4MDEsMTQ0Ljk3ODg1ODA2NDg2MDFdLFstMzcuNzQwMDM3NzAyMDIzOTgsMTQ0Ljk3OTAyNDE5NDE4MDk3XSxbLTM3Ljc0MDE5MDE2ODg0MjY3LDE0NC45NzkyMDgyNjA3NzQ2XSxbLTM3Ljc0MDM2OTQ1Nzc1MTUxLDE0NC45NzkzNDMyMDk0MTU2N10sWy0zNy43NDA1Nzk0MjQ0MjU5NiwxNDQuOTc5Mzk3MTg4ODcyMV0sWy0zNy43NDA3Nzg2NjIyNjQzNSwxNDQuOTc5Mzg2MjkyMzk3OThdLFstMzcuNzQwOTgyNjc3Nzg3NTQsMTQ0Ljk3OTM3NDQ3MzkxNDVdLFstMzcuNzQxMTY1ODIyMzcxODQsMTQ0Ljk3OTM0Mjk1Nzk1ODU4XSxbLTM3Ljc0MTM1OTY5NTc5MjIsMTQ0Ljk3OTMyMzc2MzQwMDMyXSxbLTM3Ljc0MTU0OTIxMDYyMjkxLDE0NC45NzkzMTE3NzcyNzg3OF0sWy0zNy43NDE3MzMzNjEwMzU1ODUsMTQ0Ljk3OTMxODU2NjYyMDM1XSxbLTM3Ljc0MTgxMTMxMjczNTA4LDE0NC45NzkyODY4ODMwMjYzNl0sWy0zNy43NDE2MDE3NjUxNTU3OSwxNDQuOTc5MjA4OTMxMzI2ODddLFstMzcuNzQxNDA3NDcyNjQwMjc2LDE0NC45NzkxOTcwMjkwMjQzNl0sWy0zNy43NDEyMDE4NjQ1NTU0OCwxNDQuOTc5MjI2OTUyNDE4NjhdLFstMzcuNzQwOTkyNzM2MDcxMzUsMTQ0Ljk3OTI1ODcxOTgzMTddLFstMzcuNzQwNzg5NDc0OTE5NDQsMTQ0Ljk3OTI3NTM5OTgxOTAyXSxbLTM3Ljc0MDU5OTc5MjQ1MDY2NiwxNDQuOTc5MzIzOTMxMDM4MzhdLFstMzcuNzQwNDA3NzYzMDQ5MDEsMTQ0Ljk3OTI3ODE2NTg0NzA2XSxbLTM3Ljc0MDI0MTIxNDYzMjk5LDE0NC45NzkxNTAyNTgwMDQ2N10sWy0zNy43NDAwOTU4NzI0MzE5OSwxNDQuOTc4OTc4NDI4OTg5NjVdLFstMzcuNzQwMDY1Njk3NTgwNTc2LDE0NC45Nzg4NzAzMDI0Mzg3NF0sWy0zNy43NDAwODc0OTA1Mjg4MiwxNDQuOTc4NjQyNjQ5OTQ4Nl0sWy0zNy43NDAwNzgxMDI3OTcyNywxNDQuOTc4NTM4MjExNDM1MDhdLFstMzcuNzM5ODgwMjA2MDYzMzksMTQ0Ljk3ODQ5ODU2NTAzMzA4XSxbLTM3LjczOTY4MjgxMjI0MzcsMTQ0Ljk3ODU1MTYyMjQ4MDE1XSxbLTM3LjczOTUwMzk0MjQzMDAyLDE0NC45Nzg1ODY2NTg4MzU0XSxbLTM3LjczOTMwODgxMTcyNDE4NiwxNDQuOTc4NjM1OTQ0NDI2MDZdLFstMzcuNzM5MTExMzM0MDg1NDY0LDE0NC45Nzg1NTM2MzQxMzY5Ml0sWy0zNy43Mzg5MzAyODQ5NzY5NiwxNDQuOTc4NDkxNzc1NjkxNV0sWy0zNy43Mzg3NDM5NTUyNjk0NTYsMTQ0Ljk3ODUyNTk3Mzg1NjQ1XSxbLTM3LjczODU2NzA5NzExMjUzNiwxNDQuOTc4Mzk4NDg1MTA5Ml0sWy0zNy43Mzg0MDMxNDcwODY1LDE0NC45NzgyOTc3MzQ2MzMxXSxbLTM3LjczODIwMTM5NDY3NzE2LDE0NC45NzgyNzEzMzE2MzgxXSxbLTM3LjczNzk5ODgwNDA3NzUwNiwxNDQuOTc4MjQ1NjgzMDE0NF0sWy0zNy43Mzc4NzY1MTIxMTAyMywxNDQuOTc4MjEyNTc0NDk2ODddLFstMzcuNzM3NjgyNDcxMDUxODEsMTQ0Ljk3ODE0OTU0MjU4NTAyXSxbLTM3LjczNzQ5Mzg3ODIzMDQ1LDE0NC45NzgwNzE3NTg1MjM1OF0sWy0zNy43MzczMjY0MDc4MDUwODUsMTQ0Ljk3Nzk2ODI0MjAxOTQxXSxbLTM3LjczNzE4NTE3MjczNjY0NSwxNDQuOTc3Nzk4MDA1NTY2XSxbLTM3LjczNzAxMTc1MTE2MDAyNiwxNDQuOTc3NjgwMzIzNjQ1NDddLFstMzcuNzM2ODMxMjg4Nzg0NzQsMTQ0Ljk3NzU2Mzg5OTAxMDQyXSxbLTM3LjczNjY1ODExODY2NTIyLDE0NC45Nzc0ODU3Nzk2NzI4Nl0sWy0zNy43MzY0ODM1MjM2MjIxNTUsMTQ0Ljk3NzMzMTQ2ODgzNTQ3XSxbLTM3LjczNjMyMDgzMDg4MTU5NiwxNDQuOTc3MTc4OTE4MTk3NzVdLFstMzcuNzM2Mjc0NDc4OTU3MDYsMTQ0Ljk3NzA4NjA0NjcxMDZdLFstMzcuNzM2MzA0NDg2MTcwNDEsMTQ0Ljk3Njg0NTA2Njk5NDQzXSxbLTM3LjczNjIxNzY0OTY1MzU1NCwxNDQuOTc2NjYwMTYyMjEwNDZdLFstMzcuNzM2MDI1OTU1NTI4MDIsMTQ0Ljk3NjY0ODA5MjI2OTldLFstMzcuNzM1ODIzMjgxMTA5MzMsMTQ0Ljk3NjY3OTAyMTQ5MjZdLFstMzcuNzM1NjM5MzgyMTUzNzUsMTQ0Ljk3NjY2ODc5NTU3MDczXSxbLTM3LjczNTQ2MDI2MDg4Mjk3NCwxNDQuOTc2NTc2NTk0NjM1ODRdLFstMzcuNzM1MjYyMjgwMzMwMDYsMTQ0Ljk3NjUyODk4NTQyNTgzXSxbLTM3LjczNTA5MzM4NDk4MTE1NSwxNDQuOTc2NDQzMTU0NzM3MzVdLFstMzcuNzM0OTE0OTM0MjYyNjMsMTQ0Ljk3NjM4MDI5MDQ2MzU3XSxbLTM3LjczNDc1MjY2MDYxNzIzLDE0NC45NzYyMjYxNDcyNjQyNF0sWy0zNy43MzQ1OTY1MDU3NjExNSwxNDQuOTc2MTExNDgyODI4ODZdLFstMzcuNzM0Mzk2NjgxMTg5NTQsMTQ0Ljk3NjA3MDY2Mjk2MDRdLFstMzcuNzM0MjE5NDAzOTM3NDYsMTQ0Ljk3NjEwNTYxNTQ5NjY0XSxbLTM3LjczNDA2ODYxMzQ5OTQsMTQ0Ljk3NjI2ODY0MzUxMzMyXSxbLTM3LjczMzkxNDk3MzIxNDI3LDE0NC45NzY0MTEzODczMjQzM10sWy0zNy43MzM3MzIzMzE1NDQxNiwxNDQuOTc2MzczMjQ5NjY0OV0sWy0zNy43MzM3MjM5NDk2NDA5OSwxNDQuOTc2MzQ2NTk1MjEyODJdLFstMzcuNzMzNzUzNzA1Mzk3MjUsMTQ0Ljk3NjEyMjc5ODM5ODE0XSxbLTM3LjczMzY2MzAxMzIwNDkzLDE0NC45NzU5MjE1NDg5MDNdLFstMzcuNzMzNTQxNTU5NDI3OTgsMTQ0Ljk3NTcyNTE2MDkxMTY4XSxbLTM3LjczMzQ2NTM2NzkyODE1LDE0NC45NzU1MTQ2OTEzMjMwNF0sWy0zNy43MzM0NDg0MzY0ODM3NCwxNDQuOTc1MjgyNTk2NDI0MjJdLFstMzcuNzMzNDg3NzQ3NjA5NjE1LDE0NC45NzUwNDQ4ODU2NTAyOF0sWy0zNy43MzM1MTEzMDA3NTc1MywxNDQuOTc0ODEwMzU5OTk5NTRdLFstMzcuNzMzNTU1MTM4MTExMTE1LDE0NC45NzQ3MTI2MjcwMDg1Nl0sWy0zNy43MzM2OTkzOTA2NjQ3LDE0NC45NzQ1MjI2OTMwODI3XSxbLTM3LjczMzc1MjM2NDI5Mjc0LDE0NC45NzQyNzA3MzMwNzMzNV0sWy0zNy43MzM4MTY5ODg3NjYxOSwxNDQuOTc0MDU4MDg0MTg5OV0sWy0zNy43MzM5MDc1MTMzMjA0NDYsMTQ0Ljk3Mzg0NTE4Mzg0OTMzXSxbLTM3LjczNDAwODUxNTI1MzY2LDE0NC45NzM2MTcwMjg0NDVdLFstMzcuNzM0MTE4MzE4MTg1MjEsMTQ0Ljk3MzQyOTUyNTI3MTA2XSxbLTM3LjczNDI2OTI3NjI2MTMzLDE0NC45NzMyOTEyMjM4Njg3M10sWy0zNy43MzQ0Mjk2MjIwNjksMTQ0Ljk3MzE2NTMyNzY4MzFdLFstMzcuNzM0NTcxNTI3Njg5Njk1LDE0NC45NzMwMDMzMDU0OTQ3OV0sWy0zNy43MzQ3Mzc5MDg0Njc2NSwxNDQuOTcyODQ0NzE5ODg2NzhdLFstMzcuNzM0ODcxNTE2MDA0MjA1LDE0NC45NzI2NDQ0NzYyMl0sWy0zNy43MzUwMDExODQwNDYyNywxNDQuOTcyNDU2NTUzOTUwOV0sWy0zNy43MzUwMzM3ODk2NDk2MDYsMTQ0Ljk3MjI0MDA0OTM5MTk4XSxbLTM3LjczNTAwNjIxMzE4ODE3LDE0NC45NzIxMjk0MDgyNzAxMl0sWy0zNy43MzQ4NTE2NTA4OTM2OSwxNDQuOTcxOTMxODQ2ODEyMzddLFstMzcuNzM0NzM2MjMyMDg3MDE2LDE0NC45NzE4MDk4MDYzMDIyXSxbLTM3LjczNDU1Nzc4MTM2ODQ5NCwxNDQuOTcxNjg0NDk2ODQ5NzhdLFstMzcuNzM0NDc4MzIwOTI2NDMsMTQ0Ljk3MTQ0Njg2OTg5NDg2XSxbLTM3LjczNDM2OTI3MjM2NjE2NiwxNDQuOTcxMjU3MjcxMjQ1MTJdLFstMzcuNzM0MzM2MDgwMDI5NjEsMTQ0Ljk3MTAyMTk5MTIyMzFdLFstMzcuNzM0MjM1MDc4MDk2MzksMTQ0Ljk3MDgwMTk2NjI2NDg0XSxbLTM3LjczNDA4NTU0NDk0MzgxLDE0NC45NzA2NDY5ODQ4NzUyXSxbLTM3LjczMzkyODYzNTcxNjQ0LDE0NC45NzA0Nzk1MTQ0NDk4M10sWy0zNy43MzM3OTM3NzA4OTQ0MSwxNDQuOTcwMzA1MjU0NjgyOV0sWy0zNy43MzM2NTUzMDE4NTQwMTQsMTQ0Ljk3MDE0MDk2OTM4MDc0XSxbLTM3LjczMzUxMjMwNjU4NTkxLDE0NC45Njk5ODIyOTk5NTM3XSxbLTM3LjczMzM4MjA1MTgxMDYyLDE0NC45Njk4MTEzOTI5NDgwM10sWy0zNy43MzMyNzM5MjUyNTk3MSwxNDQuOTY5NjIyMjk3MjEyNDhdLFstMzcuNzMzMTg2ODM3Mjg1NzYsMTQ0Ljk2OTQwOTM5Njg3MTkyXSxbLTM3LjczMzA5NjE0NTA5MzQ0LDE0NC45NjkxODA3Mzg1NTM0XSxbLTM3LjczMzAwMDg0Mjg1NDM4LDE0NC45Njg5NzQwNDA4MjEyXSxbLTM3LjczMjg0OTcxNzE0MDIsMTQ0Ljk2ODc5MjIzNzM0MTRdLFstMzcuNzMyNzI4MDk1NzI1MTgsMTQ0Ljk2ODYxOTMxODY3ODk4XSxbLTM3LjczMjYwOTk5NDcwOTQ5LDE0NC45Njg0MjIwOTI0OTczNV0sWy0zNy43MzI1MTc3MDk5NTU1NywxNDQuOTY4MjAxOTgzNzIwMDZdLFstMzcuNzMyNDM3NDk1MTQyMjIsMTQ0Ljk2Nzk1ODE1NDE1NjhdLFstMzcuNzMyMzg1MTkyMDY2NDMsMTQ0Ljk2Nzc0MDgxMTQwNzU3XSxbLTM3LjczMjM0OTgyMDQzNTA1LDE0NC45Njc0ODkwMTkwMzYzXSxbLTM3LjczMjMzNjgyODQ4NTEzLDE0NC45Njc0Mzg4MTE0MzYzXSxbLTM3LjczMjMyNTkzMjAxMTAxLDE0NC45NjcyMDA2ODE1NjcyXSxbLTM3LjczMjMyNDkyNjE4MjYzLDE0NC45NjcwNjkzMzcxNDQ1XSxbLTM3LjczMjMyMDMxNjEzNTg4LDE0NC45NjY5NzQxMTg3MjQ0N10sWy0zNy43MzIzMDIwNDM1ODY5NywxNDQuOTY2Nzk2NTkwMDE1M10sWy0zNy43MzIyNDc3Mjg4NTQ0MiwxNDQuOTY2NTQyOTUzNjI1MzJdLFstMzcuNzMyMjk0NDk5ODc0MTE1LDE0NC45NjYzMDUzMjY2NzA0XSxbLTM3LjczMjM4MDA3OTEwNTQ5NiwxNDQuOTY2MDg5MTU3Mzg3NjFdLFstMzcuNzMyNTM4NjY0NzEzNSwxNDQuOTY1OTQyMzkwMjYzMDhdLFstMzcuNzMyNzAyMjc5NDYzNDEsMTQ0Ljk2NTgxODA4NjYzOTA1XSxbLTM3LjczMjc1MTIyOTc3NzkzLDE0NC45NjU4NDQ5OTI1NDgyM10sWy0zNy43MzI4MDIyNzU1NjgyNSwxNDQuOTY2MDc0NDg5MDU3MDZdLFstMzcuNzMyODE1MDk5ODgwMSwxNDQuOTY2MzEwMjcxOTkzMjhdLFstMzcuNzMyODIzNjQ5NDIxMzM0LDE0NC45NjY1NDU3MTk2NTMzN10sWy0zNy43MzI4NDAxNjE3NzA1OCwxNDQuOTY2NzgwMzI5MTIzMTRdLFstMzcuNzMyODcyNzY3MzczOTIsMTQ0Ljk2Njk5OTU5OTcxMDFdLFstMzcuNzMyOTU2NTg2NDA1NjM1LDE0NC45NjcxOTk4NDMzNzY4N10sWy0zNy43MzI5ODYzNDIxNjE4OTQsMTQ0Ljk2NzM0Njc3ODEzOTQ3XSxbLTM3LjczMzA0MzMzOTEwMzQ2LDE0NC45Njc2MDMwMTI5MTk0M10sWy0zNy43MzMxMTUwODgxOTQ2MSwxNDQuOTY3ODMzMTc5OTgwNTJdLFstMzcuNzMzMTI5NTg4ODg3MDk1LDE0NC45Njc4NzU5Mjc2ODY3XSxbLTM3LjczMzIwMjAwODUzMDUsMTQ0Ljk2ODAyOTkwMzI0Nzk1XSxbLTM3LjczMzI5MzM3MTI3NTA3LDE0NC45NjgyNTI2MTA0MTUyMl0sWy0zNy43MzMzNDQzMzMyNDYzNSwxNDQuOTY4MzMwODk3MzkwODRdLFstMzcuNzMzNDc3MTAyNTkyNTksMTQ0Ljk2ODUyNjk1MDEwNjAyXSxbLTM3LjczMzYzMjUwMzA3NzM5LDE0NC45Njg3MzUwNzI3NjE3N10sWy0zNy43MzM2ODMwNDU5NTM1MSwxNDQuOTY4ODI1MzQ1ODU4OTNdLFstMzcuNzMzNjg3OTkxMjc2MzgsMTQ0Ljk2ODkyODAyNDE3Mjc4XSxbLTM3LjczMzcyMDU5Njg3OTcyLDE0NC45NjkwNjI1NTM3MTg3XV0sIm1ldGFkYXRhIjp7Im5hbWUiOiJDb2J1cmcgUnVubmluZyIsImRlc2NyaXB0aW9uIjoiT3V0IGZvciBhIGpvZyJ9LCJsYXBEZXRlY3Rpb25QYXJhbXMiOnsic3RlcE1ldGVycyI6MSwiYmVhcmluZ1RvbGVyYW5jZURlZyI6MCwiY3Jvc3NpbmdUb2xlcmFuY2VNZXRlcnMiOjB9LCJ2ZXJzaW9uIjoiMS4wIn0%3D',
    waitForSelector: '#root',
    waitForTimeout: 5000,
    viewport: { width: 1200, height: 630 },
  },
];

async function generateOGImages(): Promise<void> {
  let browser: Browser | null = null;

  try {
    console.log('üöÄ Starting OG image generation...');
    const isCI = process.env.CI === 'true' || process.env.GITHUB_ACTIONS === 'true';

    if (isCI) {
      console.log('üìù Running in CI mode (headless browser)');
    } else {
      console.log('üìù Make sure the dev server is running: pnpm dev');
    }

    // Launch browser
    console.log('üåê Launching browser...');
    browser = await puppeteer.launch({
      headless: isCI ? true : false,
      args: ['--no-sandbox', '--disable-setuid-sandbox', '--disable-dev-shm-usage'],
    });

    const page = await browser.newPage();

    for (const config of screenshotConfigs) {
      console.log(`üì∏ Capturing screenshot: ${config.name}`);

      // Set viewport if specified
      if (config.viewport) {
        await page.setViewport(config.viewport);
      }

      // Navigate to the app
      console.log(`üåê Navigating to ${config.url}...`);
      try {
        await page.goto(config.url, {
          waitUntil: 'networkidle0',
          timeout: 30000,
        });
      } catch {
        console.warn(`‚ö†Ô∏è  Could not navigate to ${config.url}. Is the dev server running?`);
        continue;
      }

      // Wait for content to load
      if (config.waitForSelector) {
        try {
          await page.waitForSelector(config.waitForSelector, {
            timeout: 10000,
          });
        } catch {
          console.warn(`‚ö†Ô∏è  Selector ${config.waitForSelector} not found, continuing...`);
        }
      }

      // Additional wait if specified
      if (config.waitForTimeout) {
        await new Promise((resolve) => setTimeout(resolve, config.waitForTimeout));
      }

      // For the course-specific screenshot, wait for the map to load
      if (config.name === 'og-image-with-course') {
        // Wait for the map container to be visible
        try {
          await page.waitForSelector('.leaflet-container', {
            timeout: 10000,
          });
        } catch {
          console.warn('‚ö†Ô∏è  Map container not found, continuing...');
        }

        // Wait for map tiles to load
        await new Promise((resolve) => setTimeout(resolve, 5000));

        // Verify the course is loaded by checking for course points
        const courseLoaded = await page.evaluate(() => {
          // Check if there are any polyline elements (the course route)
          const polylines = document.querySelectorAll(
            '.leaflet-pane .leaflet-overlay-pane svg path'
          );
          return polylines.length > 0;
        });

        if (!courseLoaded) {
          console.warn('‚ö†Ô∏è  Course not loaded, waiting longer...');
          await new Promise((resolve) => setTimeout(resolve, 5000));
        }
      }

      // Take screenshot
      const screenshotPath = path.join(process.cwd(), 'public', `${config.name}.png`);

      await page.screenshot({
        path: screenshotPath as `${string}.png`,
        type: 'png',
      });
      console.log(`‚úÖ Screenshot saved: ${screenshotPath}`);
    }

    console.log('üéâ All OG images generated successfully!');
  } catch (error) {
    console.error('‚ùå Error generating OG images:', error);
    process.exit(1);
  } finally {
    if (browser) {
      await browser.close();
    }
  }
}

// Run the script
generateOGImages().catch((error) => {
  console.error('‚ùå Script failed:', error);
  process.exit(1);
});

export { generateOGImages };
